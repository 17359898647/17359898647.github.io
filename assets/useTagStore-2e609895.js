import{_ as a}from"./SvgIcon.vue_vue_type_script_setup_true_lang-f012b298.js";import{av as l,aw as e,ax as t,ay as n,az as s,aA as u,aB as i,aC as o,aD as r,aE as c,aF as f,aG as v,aH as h,aI as d,F as p,l as g,r as m,ag as P,q as w,aJ as y,aK as R,a6 as x,a7 as A,a8 as b,u as C,s as I,aL as T,a as k,aM as L,n as _,aN as j,a9 as S,aa as F,ae as H}from"./index-53b6ca04.js";import{u as B}from"./useKeepAliveCacheStore-03219cbb.js";import{d as D}from"./debounce-b183f9b0.js";import{m as K}from"./map-d652467e.js";import{f as O}from"./findIndex-fea91066.js";function W(a,e){return!!(null==a?0:a.length)&&l(a,e,0)>-1}function z(a,l,e){for(var t=-1,n=null==a?0:a.length;++t<n;)if(e(l,a[t]))return!0;return!1}const G=u((function(a,l){return i(a)?function(a,l,u,i){var o=-1,r=W,c=!0,f=a.length,v=[],h=l.length;if(!f)return v;u&&(l=e(l,t(u))),i?(r=z,c=!1):l.length>=200&&(r=s,c=!1,l=new n(l));a:for(;++o<f;){var d=a[o],p=null==u?d:u(d);if(d=i||0!==d?d:0,c&&p==p){for(var g=h;g--;)if(l[g]===p)continue a;v.push(d)}else r(l,p,i)||v.push(d)}return v}(a,o(l,1,i,!0)):[]}));function q(a,l){var e=[];return r(a,(function(a,t,n){l(a,t,n)&&e.push(a)})),e}function E(a,l){var e;return r(a,(function(a,t,n){return!(e=l(a,t,n))})),!!e}function J(a,l,e){var t=c(a)?h:E;return e&&d(a,l,e)&&(l=void 0),t(a,v(l))}const M=a=>{const{meta:l,path:e,fullPath:t,name:n}=a;return{...l,fullPath:t||e,name:n}},N=x("useTagStore",(()=>{const l=A(),e=b(),t=m(),n=C(),{delCache:s}=B(),{setAttrs:u}=n,{isCollapsed:i,isFullscreen:o}=I(n),{allAffixRouters:r}=S(),h=m(K(r.value,(a=>M(a)))),{undo:d,history:x,canUndo:W}=T(t,{capacity:10}),z=a=>{const{fullPath:l,isHidden:e}=a;if(!h.value.some((a=>a.fullPath===l))&&!e){const l=O(h.value,(a=>a.fullPath===t.value));-1===l?h.value.push(a):h.value.splice(l+1,0,a)}},E=m([{label:()=>k("span",null,[o.value?"关闭全屏":"开启全屏"]),key:"fullScreen",icon:()=>k(a,{lineIcon:o.value?"material-symbols:fullscreen-exit":"material-symbols:fullscreen"},null)},{label:"关闭所有",key:"closeAll",icon:()=>k(a,{lineIcon:"ant-design:close-outlined"},null)},{label:"关闭其他",key:"closeOther",icon:()=>k(a,{lineIcon:"ant-design:swap-outlined"},null)},{label:"关闭右侧",key:"closeRight",icon:()=>k(a,{lineIcon:"ant-design:swap-right-outlined"},null)},{label:"关闭左侧",key:"closeLeft",icon:()=>k(a,{lineIcon:"ant-design:swap-left-outlined"},null)},{label:"刷新当前页",key:"refresh",icon:()=>k(a,{lineIcon:"ic:twotone-refresh"},null)}]),N=async(a,l)=>{await e.push(l),await R(300);const t=(n=h.value,u=a,(c(n)?f:q)(n,v(u)));var n,u;const i=G(h.value,t);H(i,(a=>{const l=O(h.value,a);-1!==l&&h.value.splice(l,1)})),await s(i)},{scrollRef:U,scrollTo:Q,contentRef:V,containerRef:X}=function(a){const{animationTime:l}={animationTime:.3,...a},{isSiderWidth:e,isCollapsedWidth:t,isCollapsed:n,isContentPadding:s}=p(g),u=m(),i=P(),o=m(),r=w((()=>(n.value?t.value:e.value)+s.value)),{width:c}=y(o),f=w((()=>c.value/2)),v=D((async a=>{var e,t;if(a<0)return;await R(1e3*l);const n=null==(e=u.value)?void 0:e.children[a];if(!n)return;const{left:s,width:o}=n.getBoundingClientRect(),c=s-r.value-f.value+o/2;null==(t=i.value)||t.scrollBy({left:c,behavior:"smooth"})}),300,{leading:!0,trailing:!0,maxWait:1e3});return{contentRef:u,containerRef:o,scrollRef:i,scrollTo:v}}();L((async()=>{z(M(l)),!l.meta.isHidden&&(t.value=l.fullPath),await Q(O(h.value,(a=>a.fullPath===t.value)))})),_((()=>l.fullPath),(async()=>{z(M(l)),!l.meta.isHidden&&(t.value=l.fullPath),await Q(O(h.value,(a=>a.fullPath===l.fullPath)))}),{flush:"post"});const{width:Y}=j();return _([Y,i],(async()=>{await Q(O(h.value,(a=>a.fullPath===l.fullPath)))})),{tagList:h,tagDropdownOptions:E,scrollRef:U,scrollTo:Q,contentRef:V,containerRef:X,createTag:M,delTagList:async a=>{const{fullPath:l}=a,n=t.value;if(l===t.value){d();let a=J(h.value,(a=>a.fullPath===t.value));for(;(!a&&0!==x.value.length||n===t.value)&&W.value;)d(),a=J(h.value,(a=>a.fullPath===t.value));await e.push(t.value===n?h.value[0].fullPath:t.value??h.value[0].fullPath)}else await e.push(h.value[0].fullPath);const u=O(h.value,(a=>a.fullPath===l));-1!==u&&h.value.splice(u,1),await s(a)},tagDropdownClick:async(a,l)=>{const{fullPath:e}=l,t={closeAll:async()=>{await N((a=>!F(a.isAffix)),h.value[0].fullPath)},closeOther:async()=>{await N((a=>a.isAffix||a.fullPath===e),e)},closeRight:async()=>{const a=O(h.value,(a=>a.fullPath===e));await N(((l,e)=>l.isAffix||e<=a),e)},closeLeft:async()=>{const a=O(h.value,(a=>a.fullPath===e));await N(((l,e)=>l.isAffix||e>=a),e)},refresh:async()=>{u("isRefreshPage",!1),await s(l),u("isRefreshPage",!0)},fullScreen:async()=>{u("isFullscreen",!o.value)},default:()=>{}},n=t[a]||t.default;await n()}}}),{persist:{paths:["tagList"]}});export{M as c,N as u};
