import{d0 as e,d1 as t,d2 as n,z as r,bW as o,d3 as a,bV as i,n as s}from"./index-b242db6d.js";function c(e,t){let{target:n}=e;for(;n;){if(n.dataset&&void 0!==n.dataset[t])return!0;n=n.parentElement}return!1}function l(c={},l){const d=e({ctrl:!1,command:!1,win:!1,shift:!1,tab:!1}),{keydown:u,keyup:f}=c,h=e=>{switch(e.key){case"Control":d.ctrl=!0;break;case"Meta":d.command=!0,d.win=!0;break;case"Shift":d.shift=!0;break;case"Tab":d.tab=!0}void 0!==u&&Object.keys(u).forEach((t=>{if(t!==e.key)return;const n=u[t];if("function"==typeof n)n(e);else{const{stop:t=!1,prevent:r=!1}=n;t&&e.stopPropagation(),r&&e.preventDefault(),n.handler(e)}}))},y=e=>{switch(e.key){case"Control":d.ctrl=!1;break;case"Meta":d.command=!1,d.win=!1;break;case"Shift":d.shift=!1;break;case"Tab":d.tab=!1}void 0!==f&&Object.keys(f).forEach((t=>{if(t!==e.key)return;const n=f[t];if("function"==typeof n)n(e);else{const{stop:t=!1,prevent:r=!1}=n;t&&e.stopPropagation(),r&&e.preventDefault(),n.handler(e)}}))},g=()=>{(void 0===l||l.value)&&(i("keydown",document,h),i("keyup",document,y)),void 0!==l&&s(l,(e=>{e?(i("keydown",document,h),i("keyup",document,y)):(o("keydown",document,h),o("keyup",document,y))}))};return t()?(n(g),r((()=>{(void 0===l||l.value)&&(o("keydown",document,h),o("keyup",document,y))}))):g(),a(d)}function d(e){return Array.isArray(e)?e:[e]}const u={STOP:"STOP"};function f(e,t){const n=t(e);void 0!==e.children&&n!==u.STOP&&e.children.forEach((e=>f(e,t)))}function h(e){return e.children}function y(e){return e.key}function g(){return!1}function k(e){return!0===e.disabled}function p(e){var t;return null==e?[]:Array.isArray(e)?e:null!==(t=e.checkedKeys)&&void 0!==t?t:[]}function v(e){var t;return null==e||Array.isArray(e)?[]:null!==(t=e.indeterminateKeys)&&void 0!==t?t:[]}function m(e,t){const n=new Set(e);return t.forEach((e=>{n.has(e)||n.add(e)})),Array.from(n)}function w(e,t){const n=new Set(e);return t.forEach((e=>{n.has(e)&&n.delete(e)})),Array.from(n)}function b(e){return"group"===(null==e?void 0:e.type)}function N(e){const t=new Map;return e.forEach(((e,n)=>{t.set(e.key,n)})),e=>{var n;return null!==(n=t.get(e))&&void 0!==n?n:null}}class A extends Error{constructor(){super(),this.message="SubtreeNotLoadedError: checking a subtree whose required nodes are not fully loaded."}}function L(e,t,n,r){const o=P(t,n,r,!1),a=P(e,n,r,!0),i=function(e,t){const n=new Set;return e.forEach((e=>{const r=t.treeNodeMap.get(e);if(void 0!==r){let e=r.parent;for(;null!==e&&!e.disabled&&!n.has(e.key);)n.add(e.key),e=e.parent}})),n}(e,n),s=[];return o.forEach((e=>{(a.has(e)||i.has(e))&&s.push(e)})),s.forEach((e=>o.delete(e))),o}function S(e,t){const{checkedKeys:n,keysToCheck:r,keysToUncheck:o,indeterminateKeys:a,cascade:i,leafOnly:s,checkStrategy:c,allowNotLoaded:l}=e;if(!i)return void 0!==r?{checkedKeys:m(n,r),indeterminateKeys:Array.from(a)}:void 0!==o?{checkedKeys:w(n,o),indeterminateKeys:Array.from(a)}:{checkedKeys:Array.from(n),indeterminateKeys:Array.from(a)};const{levelTreeNodeMap:d}=t;let u;u=void 0!==o?L(o,n,t,l):void 0!==r?function(e,t,n,r){return P(t.concat(e),n,r,!1)}(r,n,t,l):P(n,t,l,!1);const f="parent"===c,h="child"===c||s,y=u,g=new Set;for(let k=Math.max.apply(null,Array.from(d.keys()));k>=0;k-=1){const e=0===k,t=d.get(k);for(const n of t){if(n.isLeaf)continue;const{key:t,shallowLoaded:r}=n;if(h&&r&&n.children.forEach((e=>{!e.disabled&&!e.isLeaf&&e.shallowLoaded&&y.has(e.key)&&y.delete(e.key)})),n.disabled||!r)continue;let o=!0,a=!1,i=!0;for(const e of n.children){const t=e.key;if(!e.disabled)if(i&&(i=!1),y.has(t))a=!0;else{if(g.has(t)){a=!0,o=!1;break}if(o=!1,a)break}}o&&!i?(f&&n.children.forEach((e=>{!e.disabled&&y.has(e.key)&&y.delete(e.key)})),y.add(t)):a&&g.add(t),e&&h&&y.has(t)&&y.delete(t)}}return{checkedKeys:Array.from(y),indeterminateKeys:Array.from(g)}}function P(e,t,n,r){const{treeNodeMap:o,getChildren:a}=t,i=new Set,s=new Set(e);return e.forEach((e=>{const t=o.get(e);void 0!==t&&f(t,(e=>{if(e.disabled)return u.STOP;const{key:t}=e;if(!i.has(t)&&(i.add(t),s.add(t),function(e,t){return!1===e.isLeaf&&!Array.isArray(t(e))}(e.rawNode,a))){if(r)return u.STOP;if(!n)throw new A}}))})),s}function K(e,t){const n=e.siblings,r=n.length,{index:o}=e;return t?n[(o+1)%r]:o===n.length-1?null:n[o+1]}function E(e,t,{loop:n=!1,includeDisabled:r=!1}={}){const o="prev"===t?O:K,a={reverse:"prev"===t};let i=!1,s=null;return function t(c){if(null!==c){if(c===e)if(i){if(!e.disabled&&!e.isGroup)return void(s=e)}else i=!0;else if((!c.disabled||r)&&!c.ignored&&!c.isGroup)return void(s=c);if(c.isGroup){const e=G(c,a);null!==e?s=e:t(o(c,n))}else{const e=o(c,!1);if(null!==e)t(e);else{const e=function(e){return e.parent}(c);(null==e?void 0:e.isGroup)?t(o(e,n)):n&&t(o(c,!0))}}}}(e),s}function O(e,t){const n=e.siblings,r=n.length,{index:o}=e;return t?n[(o-1+r)%r]:0===o?null:n[o-1]}function G(e,t={}){const{reverse:n=!1}=t,{children:r}=e;if(r){const{length:e}=r,o=n?-1:e,a=n?-1:1;for(let i=n?e-1:0;i!==o;i+=a){const e=r[i];if(!e.disabled&&!e.ignored){if(!e.isGroup)return e;{const n=G(e,t);if(null!==n)return n}}}}return null}const x={getChild(){return this.ignored?null:G(this)},getParent(){const{parent:e}=this;return(null==e?void 0:e.isGroup)?e.getParent():e},getNext(e={}){return E(this,"next",e)},getPrev(e={}){return E(this,"prev",e)}};function C(e,t,n,r,o,a=null,i=0){const s=[];return e.forEach(((c,l)=>{var d;const u=Object.create(r);if(u.rawNode=c,u.siblings=s,u.level=i,u.index=l,u.isFirstChild=0===l,u.isLastChild=l+1===e.length,u.parent=a,!u.ignored){const e=o(c);Array.isArray(e)&&(u.children=C(e,t,n,r,o,u,i+1))}s.push(u),t.set(u.key,u),n.has(i)||n.set(i,[]),null===(d=n.get(i))||void 0===d||d.push(u)})),s}function M(e,t={}){var n;const r=new Map,o=new Map,{getDisabled:a=k,getIgnored:i=g,getIsGroup:s=b,getKey:c=y}=t,l=null!==(n=t.getChildren)&&void 0!==n?n:h,u=t.ignoreEmptyChildren?e=>{const t=l(e);return Array.isArray(t)?t.length?t:null:t}:l,f=Object.assign({get key(){return c(this.rawNode)},get disabled(){return a(this.rawNode)},get isGroup(){return s(this.rawNode)},get isLeaf(){return function(e,t){const{isLeaf:n}=e;return void 0!==n?n:!t(e)}(this.rawNode,u)},get shallowLoaded(){return function(e,t){const{isLeaf:n}=e;return!(!1===n&&!Array.isArray(t(e)))}(this.rawNode,u)},get ignored(){return i(this.rawNode)},contains(e){return function(e,t){const n=e.key;for(;t;){if(t.key===n)return!0;t=t.parent}return!1}(this,e)}},x),m=C(e,r,o,f,u);function w(e){if(null==e)return null;const t=r.get(e);return t&&!t.ignored?t:null}const N={treeNodes:m,treeNodeMap:r,levelTreeNodeMap:o,maxLevel:Math.max(...o.keys()),getChildren:u,getFlattenedNodes:e=>function(e,t){const n=t?new Set(t):void 0,r=[];return function e(t){t.forEach((t=>{r.push(t),t.isLeaf||!t.children||t.ignored||(t.isGroup||void 0===n||n.has(t.key))&&e(t.children)}))}(e),r}(m,e),getNode:function(e){if(null==e)return null;const t=r.get(e);return!t||t.isGroup||t.ignored?null:t},getPrev:function(e,t){const n=w(e);return n?n.getPrev(t):null},getNext:function(e,t){const n=w(e);return n?n.getNext(t):null},getParent:function(e){const t=w(e);return t?t.getParent():null},getChild:function(e){const t=w(e);return t?t.getChild():null},getFirstAvailableNode:()=>function(e){if(0===e.length)return null;const t=e[0];return t.isGroup||t.ignored||t.disabled?t.getNext():t}(m),getPath:(e,t={})=>function(e,{includeGroup:t=!1,includeSelf:n=!0},r){var o;const a=r.treeNodeMap;let i=null==e?null:null!==(o=a.get(e))&&void 0!==o?o:null;const s={keyPath:[],treeNodePath:[],treeNode:i};if(null==i?void 0:i.ignored)return s.treeNode=null,s;for(;i;)i.ignored||!t&&i.isGroup||s.treeNodePath.push(i),i=i.parent;return s.treeNodePath.reverse(),n||s.treeNodePath.pop(),s.keyPath=s.treeNodePath.map((e=>e.key)),s}(e,t,N),getCheckedKeys(e,t={}){const{cascade:n=!0,leafOnly:r=!1,checkStrategy:o="all",allowNotLoaded:a=!1}=t;return S({checkedKeys:p(e),indeterminateKeys:v(e),cascade:n,leafOnly:r,checkStrategy:o,allowNotLoaded:a},N)},check(e,t,n={}){const{cascade:r=!0,leafOnly:o=!1,checkStrategy:a="all",allowNotLoaded:i=!1}=n;return S({checkedKeys:p(t),indeterminateKeys:v(t),keysToCheck:null==e?[]:d(e),cascade:r,leafOnly:o,checkStrategy:a,allowNotLoaded:i},N)},uncheck(e,t,n={}){const{cascade:r=!0,leafOnly:o=!1,checkStrategy:a="all",allowNotLoaded:i=!1}=n;return S({checkedKeys:p(t),indeterminateKeys:v(t),keysToUncheck:null==e?[]:d(e),cascade:r,leafOnly:o,checkStrategy:a,allowNotLoaded:i},N)},getNonLeafKeys:(e={})=>function(e,t={}){const{preserveGroup:n=!1}=t,r=[],o=n?e=>{e.isLeaf||(r.push(e.key),a(e.children))}:e=>{e.isLeaf||(e.isGroup||r.push(e.key),a(e.children))};function a(e){e.forEach(o)}return a(e),r}(m,e)};return N}export{N as a,M as c,c as h,l as u};
