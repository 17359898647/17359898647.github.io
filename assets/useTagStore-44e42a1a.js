import{_ as a}from"./SvgIcon.vue_vue_type_script_setup_true_lang-830760e4.js";import{aX as l,aY as e,aZ as t,a_ as s,a$ as n,b0 as u,b1 as i,b2 as o,b3 as c,b4 as r,b5 as f,b6 as h,b7 as v,b8 as d,F as p,l as g,r as m,ag as P,q as b,b9 as w,ba as y,a7 as R,a8 as x,a9 as A,u as C,s as I,bb as T,a as _,bc as k,n as S,bd as j,aa as L,ab as F,af as H}from"./index-c3fd4529.js";import{u as O,s as W}from"./useKeepAliveCacheStore-f215f61a.js";import{d as B}from"./debounce-35da3279.js";import{m as D}from"./map-8663dcc2.js";function q(a,e){return!!(null==a?0:a.length)&&l(a,e,0)>-1}function K(a,l,e){for(var t=-1,s=null==a?0:a.length;++t<s;)if(e(l,a[t]))return!0;return!1}const M=u((function(a,l){return i(a)?function(a,l,u,i){var o=-1,c=q,r=!0,f=a.length,h=[],v=l.length;if(!f)return h;u&&(l=e(l,t(u))),i?(c=K,r=!1):l.length>=200&&(c=n,r=!1,l=new s(l));a:for(;++o<f;){var d=a[o],p=null==u?d:u(d);if(d=i||0!==d?d:0,r&&p==p){for(var g=v;g--;)if(l[g]===p)continue a;h.push(d)}else c(l,p,i)||h.push(d)}return h}(a,o(l,1,i,!0)):[]}));function U(a,l){var e=[];return c(a,(function(a,t,s){l(a,t,s)&&e.push(a)})),e}var X=Math.max;function Y(a,l,e){var t=null==a?0:a.length;if(!t)return-1;var s=null==e?0:v(e);return s<0&&(s=X(t+s,0)),d(a,h(l),s)}const Z=a=>{const{meta:l,path:e,fullPath:t,name:s}=a;return{...l,fullPath:t||e,name:s}},$=R("useTagStore",(()=>{const l=x(),e=A(),t=m(),s=C(),{delCache:n}=O(),{setAttrs:u}=s,{isCollapsed:i,isFullscreen:o}=I(s),{allAffixRouters:c}=L(),v=m(D(c.value,(a=>Z(a)))),{undo:d,history:R,canUndo:q}=T(t,{capacity:10}),K=a=>{const{fullPath:l,isHidden:e}=a;if(!v.value.some((a=>a.fullPath===l))&&!e){const l=Y(v.value,(a=>a.fullPath===t.value));-1===l?v.value.push(a):v.value.splice(l+1,0,a)}},X=m([{label:()=>_("span",null,[o.value?"关闭全屏":"开启全屏"]),key:"fullScreen",icon:()=>_(a,{lineIcon:o.value?"material-symbols:fullscreen-exit":"material-symbols:fullscreen"},null)},{label:"关闭所有",key:"closeAll",icon:()=>_(a,{lineIcon:"ant-design:close-outlined"},null)},{label:"关闭其他",key:"closeOther",icon:()=>_(a,{lineIcon:"ant-design:swap-outlined"},null)},{label:"关闭右侧",key:"closeRight",icon:()=>_(a,{lineIcon:"ant-design:swap-right-outlined"},null)},{label:"关闭左侧",key:"closeLeft",icon:()=>_(a,{lineIcon:"ant-design:swap-left-outlined"},null)},{label:"刷新当前页",key:"refresh",icon:()=>_(a,{lineIcon:"ic:twotone-refresh"},null)}]),$=async(a,l)=>{await e.push(l),await y(300);const t=(s=v.value,u=a,(r(s)?f:U)(s,h(u)));var s,u;const i=M(v.value,t);H(i,(a=>{const l=Y(v.value,a);-1!==l&&v.value.splice(l,1)})),await n(i)},{scrollRef:z,scrollTo:E,contentRef:G,containerRef:J}=function(a){const{animationTime:l}={animationTime:.3,...a},{isSiderWidth:e,isCollapsedWidth:t,isCollapsed:s,isContentPadding:n}=p(g),u=m(),i=P(),o=m(),c=b((()=>(s.value?t.value:e.value)+n.value)),{width:r}=w(o),f=b((()=>r.value/2)),h=B((async a=>{var e,t;if(a<0)return;await y(1e3*l);const s=null==(e=u.value)?void 0:e.children[a];if(!s)return;const{left:n,width:o}=s.getBoundingClientRect(),r=n-c.value-f.value+o/2;null==(t=i.value)||t.scrollBy({left:r,behavior:"smooth"})}),300,{leading:!0,trailing:!0,maxWait:1e3});return{contentRef:u,containerRef:o,scrollRef:i,scrollTo:h}}();k((async()=>{K(Z(l)),!l.meta.isHidden&&(t.value=l.fullPath),await E(Y(v.value,(a=>a.fullPath===t.value)))})),S((()=>l.fullPath),(async()=>{K(Z(l)),!l.meta.isHidden&&(t.value=l.fullPath),await E(Y(v.value,(a=>a.fullPath===l.fullPath)))}),{flush:"post"});const{width:N}=j();return S([N,i],(async()=>{await E(Y(v.value,(a=>a.fullPath===l.fullPath)))})),{tagList:v,tagDropdownOptions:X,scrollRef:z,scrollTo:E,contentRef:G,containerRef:J,createTag:Z,delTagList:async a=>{const{fullPath:l}=a,s=t.value;if(l===t.value){d();let a=W(v.value,(a=>a.fullPath===t.value));for(;(!a&&0!==R.value.length||s===t.value)&&q.value;)d(),a=W(v.value,(a=>a.fullPath===t.value));await e.push(t.value===s?v.value[0].fullPath:t.value??v.value[0].fullPath)}else await e.push(v.value[0].fullPath);const u=Y(v.value,(a=>a.fullPath===l));-1!==u&&v.value.splice(u,1),await n(a)},tagDropdownClick:async(a,l)=>{const{fullPath:e}=l,t={closeAll:async()=>{await $((a=>!F(a.isAffix)),v.value[0].fullPath)},closeOther:async()=>{await $((a=>a.isAffix||a.fullPath===e),e)},closeRight:async()=>{const a=Y(v.value,(a=>a.fullPath===e));await $(((l,e)=>l.isAffix||e<=a),e)},closeLeft:async()=>{const a=Y(v.value,(a=>a.fullPath===e));await $(((l,e)=>l.isAffix||e>=a),e)},refresh:async()=>{u("isRefreshPage",!1),await n(l),u("isRefreshPage",!0)},fullScreen:async()=>{u("isFullscreen",!o.value)},default:()=>{}},s=t[a]||t.default;await s()}}}),{persist:{paths:["tagList"]}});export{Z as c,$ as u};
