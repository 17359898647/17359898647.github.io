import{_ as a}from"./SvgIcon.vue_vue_type_script_setup_true_lang-Ukq-UFOb.js";import{aJ as e,aK as l,aL as t,aM as n,aN as s,aO as u,aP as i,aQ as o,aR as c,aS as r,aT as f,aU as v,aV as h,aW as d,aA as p,ac as g,r as P,a0 as m,G as w,H as y,l as R,X as x,x as A,aX as b,aY as C,ab as S,aB as T,u as I,s as _,aZ as k,e as L,a_ as j,t as H,a$ as O,a3 as W,aa as B,Y as K}from"./index-CvsuVFB3.js";import{m as U}from"./map-uvR9FuSR.js";import{d as D}from"./debounce-je9n52_G.js";import{f as F}from"./findIndex-_8KYvp9r.js";function G(a,l){return!!(null==a?0:a.length)&&e(a,l,0)>-1}function J(){var a=arguments.length;if(!a)return[];for(var e=Array(a-1),u=arguments[0],i=a;i--;)e[i-1]=arguments[i];return l(n(u)?s(u):[u],t(e,1))}function Q(a,e,l){for(var t=-1,n=null==a?0:a.length;++t<n;)if(l(e,a[t]))return!0;return!1}const X=r((function(a,e){return f(a)?function(a,e,l,t){var n=-1,s=G,r=!0,f=a.length,v=[],h=e.length;if(!f)return v;l&&(e=u(e,i(l))),t?(s=Q,r=!1):e.length>=200&&(s=c,r=!1,e=new o(e));a:for(;++n<f;){var d=a[n],p=null==l?d:l(d);if(d=t||0!==d?d:0,r&&p==p){for(var g=h;g--;)if(e[g]===p)continue a;v.push(d)}else s(e,p,t)||v.push(d)}return v}(a,t(e,1,f,!0)):[]}));function Y(a,e){var l=[];return v(a,(function(a,t,n){e(a,t,n)&&l.push(a)})),l}function $(a){const{fullPath:e,name:l}=a,t=`^${String(l||e)}`.replace(/\[([^\]]+)]/g,"[\\s\\S]*");return new RegExp(t)}const E=p("useKeepAliveCacheStore",(()=>{const{allUnKeepAliveRouters:a}=m(),e=U(g(a),(a=>$(a))),l=P(e);return{delCache:async a=>{n(a)?(l.value=J(l.value,U(a,(a=>$(a)))),await w(),l.value=e):(l.value=J(l.value,[$(a)]),await w(),l.value=e)},exclude:l}}));const M=a=>{const{meta:e,path:l,fullPath:t,name:n}=a;return{...e,fullPath:t||l,name:n}},N=p("useTagStore",(()=>{const e=S(),l=T(),t=P(),s=I(),{delCache:u}=E(),{setAttrs:i}=s,{isCollapsed:o,isFullscreen:c}=_(s),{allAffixRouters:r}=m(),f=P(U(r.value,(a=>M(a)))),{undo:v,history:p,canUndo:g}=k(t,{capacity:10}),w=a=>{const{fullPath:e,isHidden:l}=a;if(!f.value.some((a=>a.fullPath===e))&&!l){const e=F(f.value,(a=>a.fullPath===t.value));-1===e?f.value.push(a):f.value.splice(e+1,0,a)}},G=P([{icon:()=>L(a,{lineIcon:c.value?"icon-material-symbols:fullscreen-exit":"icon-material-symbols:fullscreen"},null),key:"fullScreen",label:()=>L("span",null,[c.value?"关闭全屏":"开启全屏"])},{icon:()=>L(a,{lineIcon:"icon-ant-design:close-outlined"},null),key:"closeAll",label:"关闭所有"},{icon:()=>L(a,{lineIcon:"icon-ant-design:swap-outlined"},null),key:"closeOther",label:"关闭其他"},{icon:()=>L(a,{lineIcon:"icon-ant-design:swap-right-outlined"},null),key:"closeRight",label:"关闭右侧"},{icon:()=>L(a,{lineIcon:"icon-ant-design:swap-left-outlined"},null),key:"closeLeft",label:"关闭左侧"},{icon:()=>L(a,{lineIcon:"icon-ic:twotone-refresh"},null),key:"refresh",label:"刷新当前页"}]),J=async(a,e)=>{await l.push(e),await C(300);const t=(s=f.value,i=a,(n(s)?d:Y)(s,h(i)));var s,i;const o=X(f.value,t);K(o,(a=>{const e=F(f.value,a);-1!==e&&f.value.splice(e,1)})),await u(o)},{scrollRef:Q,scrollTo:$,contentRef:N,containerRef:V}=function(a){const{animationTime:e}={animationTime:.3,...a},{isSiderWidth:l,isCollapsedWidth:t,isCollapsed:n,isContentPadding:s}=y(R),u=P(),i=x(),o=P(),c=A((()=>(n.value?t.value:l.value)+s.value)),{width:r}=b(o),f=A((()=>r.value/2)),v=D((async a=>{var l,t;if(a<0)return;await C(1e3*e);const n=null==(l=u.value)?void 0:l.children[a];if(!n)return;const{left:s,width:o}=n.getBoundingClientRect(),r=s-c.value-f.value+o/2;null==(t=i.value)||t.scrollBy({behavior:"smooth",left:r})}),300,{leading:!0,maxWait:1e3,trailing:!0});return{containerRef:o,contentRef:u,scrollRef:i,scrollTo:v}}();j((async()=>{w(M(e)),!e.meta.isHidden&&(t.value=e.fullPath),await $(F(f.value,(a=>a.fullPath===t.value)))})),H((()=>e.fullPath),(async()=>{w(M(e)),!e.meta.isHidden&&(t.value=e.fullPath),await $(F(f.value,(a=>a.fullPath===e.fullPath)))}),{flush:"post"});const{width:Z}=O();return H([Z,o],(async()=>{await $(F(f.value,(a=>a.fullPath===e.fullPath)))})),{containerRef:V,contentRef:N,createTag:M,delTagList:async a=>{const{fullPath:e}=a,n=t.value;if(e===t.value){v();let a=W(f.value,(a=>a.fullPath===t.value));for(;(!a&&0!==p.value.length||n===t.value)&&g.value;)v(),a=W(f.value,(a=>a.fullPath===t.value));await l.push(t.value===n?f.value[0].fullPath:t.value??f.value[0].fullPath)}const s=F(f.value,(a=>a.fullPath===e));-1!==s&&f.value.splice(s,1),await u(a)},scrollRef:Q,scrollTo:$,tagDropdownClick:async(a,e)=>{const{fullPath:l}=e,t={closeAll:async()=>{await J((a=>!B(a.isAffix)),f.value[0].fullPath)},closeLeft:async()=>{const a=F(f.value,(a=>a.fullPath===l));await J(((e,l)=>e.isAffix||l>=a),l)},closeOther:async()=>{await J((a=>a.isAffix||a.fullPath===l),l)},closeRight:async()=>{const a=F(f.value,(a=>a.fullPath===l));await J(((e,l)=>e.isAffix||l<=a),l)},default:()=>{},fullScreen:async()=>{i("isFullscreen",!c.value)},refresh:async()=>{i("isRefreshPage",!1),await u(e),i("isRefreshPage",!0)}};await(t[a]||t.default)()},tagDropdownOptions:G,tagList:f}}),{persist:{paths:["tagList"]}});export{N as a,M as c,E as u};
