import{_ as a}from"./SvgIcon.vue_vue_type_script_setup_true_lang-0efc81e3.js";import{az as l,aA as e,aB as t,aC as s,aD as n,aE as u,aF as i,aG as o,aH as c,aI as r,aJ as f,aK as h,F as v,l as d,r as p,ad as m,q as P,aL as g,aM as w,aN as y,ab as R,aO as b,u as x,s as A,aP as C,a as I,aQ as T,n as k,aR as _,ah as j,aa as L,a9 as S}from"./index-0d090638.js";import{u as O,s as D}from"./useKeepAliveCacheStore-8a37d402.js";import{d as F}from"./debounce-ccabbfa0.js";import{m as H}from"./map-741cce01.js";import{f as B}from"./findIndex-9bbbae93.js";function K(a,e){return!!(null==a?0:a.length)&&l(a,e,0)>-1}function W(a,l,e){for(var t=-1,s=null==a?0:a.length;++t<s;)if(e(l,a[t]))return!0;return!1}const q=u((function(a,l){return i(a)?function(a,l,u,i){var o=-1,c=K,r=!0,f=a.length,h=[],v=l.length;if(!f)return h;u&&(l=e(l,t(u))),i?(c=W,r=!1):l.length>=200&&(c=n,r=!1,l=new s(l));a:for(;++o<f;){var d=a[o],p=null==u?d:u(d);if(d=i||0!==d?d:0,r&&p==p){for(var m=v;m--;)if(l[m]===p)continue a;h.push(d)}else c(l,p,i)||h.push(d)}return h}(a,o(l,1,i,!0)):[]}));function z(a,l){var e=[];return c(a,(function(a,t,s){l(a,t,s)&&e.push(a)})),e}const E=a=>{const{meta:l,path:e,fullPath:t,name:s}=a;return{...l,fullPath:t||e,name:s}},G=y("useTagStore",(()=>{const l=R(),e=b(),t=p(),s=x(),{delCache:n}=O(),{setAttrs:u}=s,{isCollapsed:i,isFullscreen:o}=A(s),{allAffixRouters:c}=j(),y=p(H(c.value,(a=>E(a)))),{undo:K,history:W,canUndo:G}=C(t,{capacity:10}),J=a=>{const{fullPath:l,isHidden:e}=a;if(!y.value.some((a=>a.fullPath===l))&&!e){const l=B(y.value,(a=>a.fullPath===t.value));-1===l?y.value.push(a):y.value.splice(l+1,0,a)}},M=p([{label:()=>I("span",null,[o.value?"关闭全屏":"开启全屏"]),key:"fullScreen",icon:()=>I(a,{lineIcon:o.value?"material-symbols:fullscreen-exit":"material-symbols:fullscreen"},null)},{label:"关闭所有",key:"closeAll",icon:()=>I(a,{lineIcon:"ant-design:close-outlined"},null)},{label:"关闭其他",key:"closeOther",icon:()=>I(a,{lineIcon:"ant-design:swap-outlined"},null)},{label:"关闭右侧",key:"closeRight",icon:()=>I(a,{lineIcon:"ant-design:swap-right-outlined"},null)},{label:"关闭左侧",key:"closeLeft",icon:()=>I(a,{lineIcon:"ant-design:swap-left-outlined"},null)},{label:"刷新当前页",key:"refresh",icon:()=>I(a,{lineIcon:"ic:twotone-refresh"},null)}]),N=async(a,l)=>{await e.push(l),await w(300);const t=(s=y.value,u=a,(r(s)?f:z)(s,h(u)));var s,u;const i=q(y.value,t);S(i,(a=>{const l=B(y.value,a);-1!==l&&y.value.splice(l,1)})),await n(i)},{scrollRef:Q,scrollTo:U,contentRef:V,containerRef:X}=function(a){const{animationTime:l}={animationTime:.3,...a},{isSiderWidth:e,isCollapsedWidth:t,isCollapsed:s,isContentPadding:n}=v(d),u=p(),i=m(),o=p(),c=P((()=>(s.value?t.value:e.value)+n.value)),{width:r}=g(o),f=P((()=>r.value/2)),h=F((async a=>{var e,t;if(a<0)return;await w(1e3*l);const s=null==(e=u.value)?void 0:e.children[a];if(!s)return;const{left:n,width:o}=s.getBoundingClientRect(),r=n-c.value-f.value+o/2;null==(t=i.value)||t.scrollBy({left:r,behavior:"smooth"})}),300,{leading:!0,trailing:!0,maxWait:1e3});return{contentRef:u,containerRef:o,scrollRef:i,scrollTo:h}}();T((async()=>{J(E(l)),!l.meta.isHidden&&(t.value=l.fullPath),await U(B(y.value,(a=>a.fullPath===t.value)))})),k((()=>l.fullPath),(async()=>{J(E(l)),!l.meta.isHidden&&(t.value=l.fullPath),await U(B(y.value,(a=>a.fullPath===l.fullPath)))}),{flush:"post"});const{width:Y}=_();return k([Y,i],(async()=>{await U(B(y.value,(a=>a.fullPath===l.fullPath)))})),{tagList:y,tagDropdownOptions:M,scrollRef:Q,scrollTo:U,contentRef:V,containerRef:X,createTag:E,delTagList:async a=>{const{fullPath:l}=a,s=t.value;if(l===t.value){K();let a=D(y.value,(a=>a.fullPath===t.value));for(;(!a&&0!==W.value.length||s===t.value)&&G.value;)K(),a=D(y.value,(a=>a.fullPath===t.value));await e.push(t.value===s?y.value[0].fullPath:t.value??y.value[0].fullPath)}else await e.push(y.value[0].fullPath);const u=B(y.value,(a=>a.fullPath===l));-1!==u&&y.value.splice(u,1),await n(a)},tagDropdownClick:async(a,l)=>{const{fullPath:e}=l,t={closeAll:async()=>{await N((a=>!L(a.isAffix)),y.value[0].fullPath)},closeOther:async()=>{await N((a=>a.isAffix||a.fullPath===e),e)},closeRight:async()=>{const a=B(y.value,(a=>a.fullPath===e));await N(((l,e)=>l.isAffix||e<=a),e)},closeLeft:async()=>{const a=B(y.value,(a=>a.fullPath===e));await N(((l,e)=>l.isAffix||e>=a),e)},refresh:async()=>{u("isRefreshPage",!1),await n(l),u("isRefreshPage",!0)},fullScreen:async()=>{u("isFullscreen",!o.value)},default:()=>{}},s=t[a]||t.default;await s()}}}),{persist:{paths:["tagList"]}});export{E as c,G as u};
