import{_ as a}from"./SvgIcon.vue_vue_type_script_setup_true_lang-8113d4b7.js";import{aD as e,aE as l,aF as n,aG as t,aH as s,aI as u,aJ as i,aK as o,aL as c,aM as r,aN as f,aO as v,aP as h,aQ as d,aR as p,aS as g,a6 as m,G as P,r as w,a9 as y,E as R,F as x,l as A,af as b,q as I,aT as C,aU as T,a7 as S,a8 as k,u as _,s as L,aV as j,a as H,aW as E,n as F,aX as O,aa as W,ae as D}from"./index-b8a9e8d3.js";import{m as G}from"./map-7858a4c6.js";import{d as K}from"./debounce-b5419b50.js";import{f as U}from"./findIndex-ce8d715f.js";function B(a,l){return!!(null==a?0:a.length)&&e(a,l,0)>-1}function q(){var a=arguments.length;if(!a)return[];for(var e=Array(a-1),u=arguments[0],i=a;i--;)e[i-1]=arguments[i];return l(t(u)?s(u):[u],n(e,1))}function J(a,e,l){for(var n=-1,t=null==a?0:a.length;++n<t;)if(l(e,a[n]))return!0;return!1}const M=r((function(a,e){return f(a)?function(a,e,l,n){var t=-1,s=B,r=!0,f=a.length,v=[],h=e.length;if(!f)return v;l&&(e=u(e,i(l))),n?(s=J,r=!1):e.length>=200&&(s=c,r=!1,e=new o(e));a:for(;++t<f;){var d=a[t],p=null==l?d:l(d);if(d=n||0!==d?d:0,r&&p==p){for(var g=h;g--;)if(e[g]===p)continue a;v.push(d)}else s(e,p,n)||v.push(d)}return v}(a,n(e,1,f,!0)):[]}));function N(a,e){var l=[];return v(a,(function(a,n,t){e(a,n,t)&&l.push(a)})),l}function Q(a,e){var l;return v(a,(function(a,n,t){return!(l=e(a,n,t))})),!!l}function V(a,e,l){var n=t(a)?p:Q;return l&&g(a,e,l)&&(e=void 0),n(a,d(e))}function X(a){const{fullPath:e,name:l}=a;return new RegExp(`${String(l||e)}`)}const $=m("useKeepAliveCacheStore",(()=>{const{allUnKeepAliveRouters:a}=y(),e=G(P(a),(a=>X(a))),l=w(e);return{delCache:async a=>{t(a)?(l.value=q(l.value,G(a,(a=>X(a)))),await R(),l.value=e):(l.value=q(l.value,[X(a)]),await R(),l.value=e)},exclude:l}}));const z=a=>{const{meta:e,path:l,fullPath:n,name:t}=a;return{...e,fullPath:n||l,name:t}},Y=m("useTagStore",(()=>{const e=S(),l=k(),n=w(),s=_(),{delCache:u}=$(),{setAttrs:i}=s,{isCollapsed:o,isFullscreen:c}=L(s),{allAffixRouters:r}=y(),f=w(G(r.value,(a=>z(a)))),{undo:v,history:p,canUndo:g}=j(n,{capacity:10}),m=a=>{const{fullPath:e,isHidden:l}=a;if(!f.value.some((a=>a.fullPath===e))&&!l){const e=U(f.value,(a=>a.fullPath===n.value));-1===e?f.value.push(a):f.value.splice(e+1,0,a)}},P=w([{icon:()=>H(a,{lineIcon:c.value?"icon-material-symbols:fullscreen-exit":"icon-material-symbols:fullscreen"},null),key:"fullScreen",label:()=>H("span",null,[c.value?"关闭全屏":"开启全屏"])},{icon:()=>H(a,{lineIcon:"icon-ant-design:close-outlined"},null),key:"closeAll",label:"关闭所有"},{icon:()=>H(a,{lineIcon:"icon-ant-design:swap-outlined"},null),key:"closeOther",label:"关闭其他"},{icon:()=>H(a,{lineIcon:"icon-ant-design:swap-right-outlined"},null),key:"closeRight",label:"关闭右侧"},{icon:()=>H(a,{lineIcon:"icon-ant-design:swap-left-outlined"},null),key:"closeLeft",label:"关闭左侧"},{icon:()=>H(a,{lineIcon:"icon-ic:twotone-refresh"},null),key:"refresh",label:"刷新当前页"}]),R=async(a,e)=>{await l.push(e),await T(300);const n=(s=f.value,i=a,(t(s)?h:N)(s,d(i)));var s,i;const o=M(f.value,n);D(o,(a=>{const e=U(f.value,a);-1!==e&&f.value.splice(e,1)})),await u(o)},{scrollRef:B,scrollTo:q,contentRef:J,containerRef:Q}=function(a){const{animationTime:e}={animationTime:.3,...a},{isSiderWidth:l,isCollapsedWidth:n,isCollapsed:t,isContentPadding:s}=x(A),u=w(),i=b(),o=w(),c=I((()=>(t.value?n.value:l.value)+s.value)),{width:r}=C(o),f=I((()=>r.value/2)),v=K((async a=>{var l,n;if(a<0)return;await T(1e3*e);const t=null==(l=u.value)?void 0:l.children[a];if(!t)return;const{left:s,width:o}=t.getBoundingClientRect(),r=s-c.value-f.value+o/2;null==(n=i.value)||n.scrollBy({behavior:"smooth",left:r})}),300,{leading:!0,maxWait:1e3,trailing:!0});return{containerRef:o,contentRef:u,scrollRef:i,scrollTo:v}}();E((async()=>{m(z(e)),!e.meta.isHidden&&(n.value=e.fullPath),await q(U(f.value,(a=>a.fullPath===n.value)))})),F((()=>e.fullPath),(async()=>{m(z(e)),!e.meta.isHidden&&(n.value=e.fullPath),await q(U(f.value,(a=>a.fullPath===e.fullPath)))}),{flush:"post"});const{width:X}=O();return F([X,o],(async()=>{await q(U(f.value,(a=>a.fullPath===e.fullPath)))})),{containerRef:Q,contentRef:J,createTag:z,delTagList:async a=>{const{fullPath:e}=a,t=n.value;if(e===n.value){v();let a=V(f.value,(a=>a.fullPath===n.value));for(;(!a&&0!==p.value.length||t===n.value)&&g.value;)v(),a=V(f.value,(a=>a.fullPath===n.value));await l.push(n.value===t?f.value[0].fullPath:n.value??f.value[0].fullPath)}const s=U(f.value,(a=>a.fullPath===e));-1!==s&&f.value.splice(s,1),await u(a)},scrollRef:B,scrollTo:q,tagDropdownClick:async(a,e)=>{const{fullPath:l}=e,n={closeAll:async()=>{await R((a=>!W(a.isAffix)),f.value[0].fullPath)},closeLeft:async()=>{const a=U(f.value,(a=>a.fullPath===l));await R(((e,l)=>e.isAffix||l>=a),l)},closeOther:async()=>{await R((a=>a.isAffix||a.fullPath===l),l)},closeRight:async()=>{const a=U(f.value,(a=>a.fullPath===l));await R(((e,l)=>e.isAffix||l<=a),l)},default:()=>{},fullScreen:async()=>{i("isFullscreen",!c.value)},refresh:async()=>{i("isRefreshPage",!1),await u(e),i("isRefreshPage",!0)}};await(n[a]||n.default)()},tagDropdownOptions:P,tagList:f}}),{persist:{paths:["tagList"]}});export{$ as a,z as c,V as s,Y as u};
