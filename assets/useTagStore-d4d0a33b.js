import{_ as a}from"./SvgIcon.vue_vue_type_script_setup_true_lang-db2cc328.js";import{au as l,av as e,aw as t,ax as n,ay as s,az as u,aA as i,aB as o,aC as r,aD as c,aE as f,aF as v,aG as h,aH as d,F as p,l as m,r as g,ae as P,q as w,aI as y,aJ as R,aK as b,ac as x,aL as A,u as C,s as I,aM as T,a as k,aN as _,n as j,aO as L,ah as S,ab as B,aa as F}from"./index-fe7feb26.js";import{u as H}from"./useKeepAliveCacheStore-bf5d0573.js";import{d as O}from"./debounce-291d9800.js";import{m as D}from"./map-214dc0fe.js";import{f as W}from"./findIndex-4270538b.js";function K(a,e){return!!(null==a?0:a.length)&&l(a,e,0)>-1}function M(a,l,e){for(var t=-1,n=null==a?0:a.length;++t<n;)if(e(l,a[t]))return!0;return!1}const N=u((function(a,l){return i(a)?function(a,l,u,i){var o=-1,r=K,c=!0,f=a.length,v=[],h=l.length;if(!f)return v;u&&(l=e(l,t(u))),i?(r=M,c=!1):l.length>=200&&(r=s,c=!1,l=new n(l));a:for(;++o<f;){var d=a[o],p=null==u?d:u(d);if(d=i||0!==d?d:0,c&&p==p){for(var m=h;m--;)if(l[m]===p)continue a;v.push(d)}else r(l,p,i)||v.push(d)}return v}(a,o(l,1,i,!0)):[]}));function q(a,l){var e=[];return r(a,(function(a,t,n){l(a,t,n)&&e.push(a)})),e}function z(a,l){var e;return r(a,(function(a,t,n){return!(e=l(a,t,n))})),!!e}function E(a,l,e){var t=c(a)?h:z;return e&&d(a,l,e)&&(l=void 0),t(a,v(l))}const G=a=>{const{meta:l,path:e,fullPath:t,name:n}=a;return{...l,fullPath:t||e,name:n}},J=b("useTagStore",(()=>{const l=x(),e=A(),t=g(),n=C(),{delCache:s}=H(),{setAttrs:u}=n,{isCollapsed:i,isFullscreen:o}=I(n),{allAffixRouters:r}=S(),h=g(D(r.value,(a=>G(a)))),{undo:d,history:b,canUndo:K}=T(t,{capacity:10}),M=a=>{const{fullPath:l,isHidden:e}=a;if(!h.value.some((a=>a.fullPath===l))&&!e){const l=W(h.value,(a=>a.fullPath===t.value));-1===l?h.value.push(a):h.value.splice(l+1,0,a)}},z=g([{label:()=>k("span",null,[o.value?"关闭全屏":"开启全屏"]),key:"fullScreen",icon:()=>k(a,{lineIcon:o.value?"material-symbols:fullscreen-exit":"material-symbols:fullscreen"},null)},{label:"关闭所有",key:"closeAll",icon:()=>k(a,{lineIcon:"ant-design:close-outlined"},null)},{label:"关闭其他",key:"closeOther",icon:()=>k(a,{lineIcon:"ant-design:swap-outlined"},null)},{label:"关闭右侧",key:"closeRight",icon:()=>k(a,{lineIcon:"ant-design:swap-right-outlined"},null)},{label:"关闭左侧",key:"closeLeft",icon:()=>k(a,{lineIcon:"ant-design:swap-left-outlined"},null)},{label:"刷新当前页",key:"refresh",icon:()=>k(a,{lineIcon:"ic:twotone-refresh"},null)}]),J=async(a,l)=>{await e.push(l),await R(300);const t=(n=h.value,u=a,(c(n)?f:q)(n,v(u)));var n,u;const i=N(h.value,t);F(i,(a=>{const l=W(h.value,a);-1!==l&&h.value.splice(l,1)})),await s(i)},{scrollRef:U,scrollTo:Q,contentRef:V,containerRef:X}=function(a){const{animationTime:l}={animationTime:.3,...a},{isSiderWidth:e,isCollapsedWidth:t,isCollapsed:n,isContentPadding:s}=p(m),u=g(),i=P(),o=g(),r=w((()=>(n.value?t.value:e.value)+s.value)),{width:c}=y(o),f=w((()=>c.value/2)),v=O((async a=>{var e,t;if(a<0)return;await R(1e3*l);const n=null==(e=u.value)?void 0:e.children[a];if(!n)return;const{left:s,width:o}=n.getBoundingClientRect(),c=s-r.value-f.value+o/2;null==(t=i.value)||t.scrollBy({left:c,behavior:"smooth"})}),300,{leading:!0,trailing:!0,maxWait:1e3});return{contentRef:u,containerRef:o,scrollRef:i,scrollTo:v}}();_((async()=>{M(G(l)),!l.meta.isHidden&&(t.value=l.fullPath),await Q(W(h.value,(a=>a.fullPath===t.value)))})),j((()=>l.fullPath),(async()=>{M(G(l)),!l.meta.isHidden&&(t.value=l.fullPath),await Q(W(h.value,(a=>a.fullPath===l.fullPath)))}),{flush:"post"});const{width:Y}=L();return j([Y,i],(async()=>{await Q(W(h.value,(a=>a.fullPath===l.fullPath)))})),{tagList:h,tagDropdownOptions:z,scrollRef:U,scrollTo:Q,contentRef:V,containerRef:X,createTag:G,delTagList:async a=>{const{fullPath:l}=a,n=t.value;if(l===t.value){d();let a=E(h.value,(a=>a.fullPath===t.value));for(;(!a&&0!==b.value.length||n===t.value)&&K.value;)d(),a=E(h.value,(a=>a.fullPath===t.value));await e.push(t.value===n?h.value[0].fullPath:t.value??h.value[0].fullPath)}else await e.push(h.value[0].fullPath);const u=W(h.value,(a=>a.fullPath===l));-1!==u&&h.value.splice(u,1),await s(a)},tagDropdownClick:async(a,l)=>{const{fullPath:e}=l,t={closeAll:async()=>{await J((a=>!B(a.isAffix)),h.value[0].fullPath)},closeOther:async()=>{await J((a=>a.isAffix||a.fullPath===e),e)},closeRight:async()=>{const a=W(h.value,(a=>a.fullPath===e));await J(((l,e)=>l.isAffix||e<=a),e)},closeLeft:async()=>{const a=W(h.value,(a=>a.fullPath===e));await J(((l,e)=>l.isAffix||e>=a),e)},refresh:async()=>{u("isRefreshPage",!1),await s(l),u("isRefreshPage",!0)},fullScreen:async()=>{u("isFullscreen",!o.value)},default:()=>{}},n=t[a]||t.default;await n()}}}),{persist:{paths:["tagList"]}});export{G as c,J as u};
